CREATE TABLE LOCATION(
    LOCATION_ID NUMBER(4),
    regional_group VARCHAR2(20)
);
DROP TABLE LOCATION;
CREATE TABLE DEPARTMENT(
    DEPARTMENT_ID NUMBER(4),
    NAME VARCHAR2(20),
    LOCATION_ID NUMBER(4)
);
CREATE TABLE JOB(
    JOB_ID VARCHAR2(10),
    FUNCTION varchar2(20)
);
CREATE TABLE EMPLOYEE(
    EMPLOYEE_ID NUMBER(6),
    LAST_NAME VARCHAR2(25),
    FIRST_NAME VARCHAR2(20),
    MIDLE_NAME VARCHAR2(25),
    JOB_ID NUMBER(4),
    MANAGER_ID NUMBER(5),
    HIRE_DATE DATE,
    SALARY NUMBER(8,2),
    COMM NUMBER(3),
    DEPARTMENT_ID NUMBER(4)
);
-- describe
DESC LOCATION;
DESC DEPARTMENT;
DESC EMPLOYEE;
DESC JOB;

INSERT INTO LOCATION VALUES(122,'NEW YORK');
INSERT INTO LOCATION VALUES(123,'DALLAS');
INSERT INTO LOCATION VALUES(124, 'CHIIAGO');
INSERT INTO LOCATION VALUES(167,'BOSTON');

INSERT INTO DEPARTMENT VALUES(10,'ACCOUNTING',122);
INSERT INTO DEPARTMENT VALUES(20,'RESEARCH',124);
INSERT INTO DEPARTMENT VALUES(30,'SALES',123);
INSERT INTO DEPARTMENT VALUES(40,'OPERATIONS',167);

INSERT INTO JOB VALUES(667,'CLERK');
INSERT INTO JOB VALUES(668,'STAFF');
INSERT INTO JOB VALUES(669,'ANAALYST');
INSERT INTO JOB VALUES(670,'SALESPERSON');
INSERT INTO JOB VALUES(671,'MANAGER');
INSERT INTO JOB VALUES(672,'PRESIDENT');

INSERT INTO EMPLOYEE VALUES(7369,'SMITH','JOHN','Q',667,7902,'17-DEC-1984',800,NULL,20);
INSERT INTO EMPLOYEE VALUES(7499,'ALLEN','KEVIN','J',670,7698,'20-FEB-1985',1600,300,30);
INSERT INTO EMPLOYEE VALUES(7505,'DOYLE','JEAN','K',671,7839,'04-APR-1984',2850,NULL,30);
INSERT INTO EMPLOYEE VALUES(7506,'DENNINS','LYNN','S',671,7839,'15-MAY-1985',2750,NULL,30);
INSERT INTO EMPLOYEE VALUES(7507,'BAKER','LESLIE','D',671,7839,'10-JUN-1985',2200,NULL,40);
INSERT INTO EMPLOYEE VALUES(7521,'WARK','CYNTHIA','D',670,7898,'22-FEB-1985',1250,500,30);

-- 1
SELECT * FROM EMPLOYEE;
-- 2
SELECT * FROM DEPARTMENT;
-- 3
SELECT * FROM JOB;
-- 4
SELECT * FROM LOCATION;
-- 5
SELECT FIRST_NAME,LAST_NAME,SALARY,COMM FROM EMPLOYEE;
-- 6
SELECT EMPLOYEE_ID AS "ID ",LAST_NAME AS "Name",DEPARTMENT_ID AS "department ID" FROM EMPLOYEE;
-- 7
SELECT FIRST_NAME, LAST_NAME, SALARY*12 AS "Annual Salary" FROM EMPLOYEE;

-- SIMPLE JOIN
-- 48
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT.NAME FROM EMPLOYEE, DEPARTMENT WHERE EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID;
-- 49
SELECT EMPLOYEE_ID, LAST_NAME, JOB.FUNCTION FROM EMPLOYEE, JOB WHERE EMPLOYEE.JOB_ID = JOB.JOB_ID;
-- 50
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT.NAME, LOCATION.regional_group FROM EMPLOYEE, DEPARTMENT, LOCATION WHERE EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID AND DEPARTMENT.LOCATION_ID = LOCATION.LOCATION_ID;
-- 51
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT.NAME FROM EMPLOYEE, DEPARTMENT WHERE EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID AND EMPLOYEE.DEPARTMENT_ID <> 20;
-- 52
SELECT COUNT(*) FROM EMPLOYEE, DEPARTMENT WHERE EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID AND DEPARTMENT.NAME = 'SALES';
-- 53
SELECT DEPARTMENT.NAME FROM DEPARTMENT, EMPLOYEE WHERE DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID GROUP BY DEPARTMENT.NAME HAVING COUNT(*) >= 5 ORDER BY DEPARTMENT.NAME;
-- 54
SELECT JOB.FUNCTION, COUNT(*) FROM JOB, EMPLOYEE WHERE JOB.JOB_ID = EMPLOYEE.JOB_ID GROUP BY JOB.FUNCTION ORDER BY JOB.FUNCTION;
-- 55
-- .How many employees working in "New York".
SELECT COUNT(*) FROM EMPLOYEE, DEPARTMENT, LOCATION
WHERE EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID
AND DEPARTMENT.LOCATION_ID = LOCATION.LOCATION_ID
AND LOCATION.regional_group = 'NEW YORK';

-- sub query
-- 34 Display the employee who got the maximum salary.
SELECT * FROM EMPLOYEE WHERE SALARY = (SELECT MAX(SALARY) FROM EMPLOYEE);
-- 35 Display the employees who are working in Sales department.
SELECT *
FROM EMPLOYEE
WHERE DEPARTMENT_ID = (
  SELECT DEPARTMENT_ID
  FROM DEPARTMENT
  WHERE NAME = 'SALES'
);
-- 36 Display the employees who are working as "Clerk".
SELECT * FROM EMPLOYEE WHERE JOB_ID = (
    SELECT JOB_ID 
    FROM JOB 
    WHERE FUNCTION = 'CLERK'
);
-- 37 Display the employees who are working in "New York".
SELECT * FROM EMPLOYEE WHERE DEPARTMENT_ID = (
    SELECT DEPARTMENT_ID 
    FROM DEPARTMENT 
    WHERE LOCATION_ID = (
        SELECT LOCATION_ID 
        FROM LOCATION 
        WHERE regional_group = 'NEW YORK'
    )
);
-- 38 Find out no.of employees working in "Sales" department.
SELECT COUNT(*) FROM EMPLOYEE WHERE DEPARTMENT_ID = (
    SELECT DEPARTMENT_ID 
    FROM DEPARTMENT 
    WHERE NAME = 'SALES'
);
-- 39 Update the employees salaries, who are working as Clerk on the basis of 10%.
UPDATE EMPLOYEE SET SALARY = SALARY + (SALARY * 0.1) WHERE JOB_ID = (
    SELECT JOB_ID 
    FROM JOB 
    WHERE FUNCTION = 'CLERK'
);
-- 40 Delete the employees who are working in accounting department,
DELETE FROM EMPLOYEE WHERE DEPARTMENT_ID = (
    SELECT DEPARTMENT_ID 
    FROM DEPARTMENT 
    WHERE NAME = 'ACCOUNTING'
);
-- 41 Display the second highest salary drawing employee details,
SELECT * FROM EMPLOYEE WHERE SALARY = (
    SELECT MAX(SALARY) FROM EMPLOYEE WHERE SALARY < (
        SELECT MAX(SALARY) FROM EMPLOYEE
    )
);
-- 42 Display the Nth highest salary drawing employee details
SELECT * FROM EMPLOYEE WHERE SAL
